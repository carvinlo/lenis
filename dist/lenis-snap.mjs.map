{"version":3,"file":"lenis-snap.mjs","sources":["../../src/element.ts","../../src/uid.ts","../../src/index.ts","../../src/debounce.ts"],"sourcesContent":["function removeParentSticky(element: HTMLElement) {\n  const position = getComputedStyle(element).position\n\n  const isSticky = position === 'sticky'\n\n  if (isSticky) {\n    element.style.setProperty('position', 'static')\n    element.dataset.sticky = 'true'\n  }\n\n  if (element.offsetParent) {\n    removeParentSticky(element.offsetParent as HTMLElement)\n  }\n}\n\nfunction addParentSticky(element: HTMLElement) {\n  if (element?.dataset?.sticky === 'true') {\n    element.style.removeProperty('position')\n    delete element.dataset.sticky\n  }\n\n  if (element.offsetParent) {\n    addParentSticky(element.offsetParent as HTMLElement)\n  }\n}\n\nfunction offsetTop(element: HTMLElement, accumulator = 0) {\n  const top = accumulator + element.offsetTop\n  if (element.offsetParent) {\n    return offsetTop(element.offsetParent as HTMLElement, top)\n  }\n  return top\n}\n\nfunction offsetLeft(element: HTMLElement, accumulator = 0) {\n  const left = accumulator + element.offsetLeft\n  if (element.offsetParent) {\n    return offsetLeft(element.offsetParent as HTMLElement, left)\n  }\n  return left\n}\n\nfunction scrollTop(element: HTMLElement, accumulator = 0) {\n  const top = accumulator + element.scrollTop\n  if (element.offsetParent) {\n    return scrollTop(element.offsetParent as HTMLElement, top)\n  }\n  return top + window.scrollY\n}\n\nfunction scrollLeft(element: HTMLElement, accumulator = 0) {\n  const left = accumulator + element.scrollLeft\n  if (element.offsetParent) {\n    return scrollLeft(element.offsetParent as HTMLElement, left)\n  }\n  return left + window.scrollX\n}\n\nexport type SnapElementOptions = {\n  align?: string[]\n  ignoreSticky?: boolean\n  ignoreTransform?: boolean\n}\n\ntype Rect = {\n  top: number\n  left: number\n  width: number\n  height: number\n  x: number\n  y: number\n  bottom: number\n  right: number\n  element: HTMLElement\n}\n\nexport class SnapElement {\n  element: HTMLElement\n  options: SnapElementOptions\n  align: string[]\n  // @ts-ignore\n  rect: Rect = {}\n  wrapperResizeObserver: ResizeObserver\n  resizeObserver: ResizeObserver\n\n  constructor(\n    element: HTMLElement,\n    {\n      align = ['start'],\n      ignoreSticky = true,\n      ignoreTransform = false,\n    }: SnapElementOptions = {}\n  ) {\n    this.element = element\n\n    this.options = { align, ignoreSticky, ignoreTransform }\n\n    // this.ignoreSticky = ignoreSticky\n    // this.ignoreTransform = ignoreTransform\n\n    this.align = [align].flat()\n\n    // TODO: assing rect immediately\n\n    this.wrapperResizeObserver = new ResizeObserver(this.onWrapperResize)\n    this.wrapperResizeObserver.observe(document.body)\n    this.onWrapperResize()\n\n    this.resizeObserver = new ResizeObserver(this.onResize)\n    this.resizeObserver.observe(this.element)\n    this.setRect({\n      width: this.element.offsetWidth,\n      height: this.element.offsetHeight,\n    })\n  }\n\n  destroy() {\n    this.wrapperResizeObserver.disconnect()\n    this.resizeObserver.disconnect()\n  }\n\n  setRect({\n    top,\n    left,\n    width,\n    height,\n    element,\n  }: {\n    top?: number\n    left?: number\n    width?: number\n    height?: number\n    element?: HTMLElement\n  } = {}) {\n    top = top ?? this.rect.top\n    left = left ?? this.rect.left\n    width = width ?? this.rect.width\n    height = height ?? this.rect.height\n    element = element ?? this.rect.element\n\n    if (\n      top === this.rect.top &&\n      left === this.rect.left &&\n      width === this.rect.width &&\n      height === this.rect.height &&\n      element === this.rect.element\n    )\n      return\n\n    this.rect.top = top\n    this.rect.y = top\n    this.rect.width = width\n    this.rect.height = height\n    this.rect.left = left\n    this.rect.x = left\n    this.rect.bottom = top + height\n    this.rect.right = left + width\n  }\n\n  onWrapperResize = () => {\n    let top, left\n\n    if (this.options.ignoreSticky) removeParentSticky(this.element)\n    if (this.options.ignoreTransform) {\n      top = offsetTop(this.element)\n      left = offsetLeft(this.element)\n    } else {\n      const rect = this.element.getBoundingClientRect()\n      top = rect.top + scrollTop(this.element)\n      left = rect.left + scrollLeft(this.element)\n    }\n    if (this.options.ignoreSticky) addParentSticky(this.element)\n\n    this.setRect({ top, left })\n  }\n\n  onResize = ([entry]: ResizeObserverEntry[]) => {\n    const width = entry.borderBoxSize[0].inlineSize\n    const height = entry.borderBoxSize[0].blockSize\n\n    this.setRect({ width, height })\n  }\n}\n","let index = 0\n\nexport type UID = number\n\nexport function uid(): UID {\n  return index++\n}\n","import Lenis, { type UserData } from 'lenis'\nimport { debounce } from './debounce'\nimport { SnapElement, SnapElementOptions } from './element'\nimport type { SnapItem, SnapOptions } from './types'\nimport { UID, uid } from './uid'\n\n// TODO:\n// - horizontal\n// - fix trackpad snapping too soon due to velocity (fuck Apple)\n// - fix wheel scrolling after limits (see console scroll to)\n// - fix touch scroll, do not snap when not released\n// - arrow, spacebar\n\n// Types\nexport * from './types'\n\ntype RequiredPick<T, F extends keyof T> = Omit<T, F> & Required<Pick<T, F>>\n\n/**\n * Snap class to handle the snap functionality\n *\n * @example\n * const snap = new Snap(lenis, {\n *   type: 'mandatory', // 'mandatory', 'proximity'\n *   lerp: 0.1,\n *   duration: 1,\n *   easing: (t) => t,\n *   onSnapStart: (snap) => {\n *     console.log('onSnapStart', snap)\n *   },\n *   onSnapComplete: (snap) => {\n *     console.log('onSnapComplete', snap)\n *   },\n * })\n *\n * snap.add(500) // snap at 500px\n *\n * const someElement = document.querySelector('#some-element')\n *\n * snap.addElement(someElement) // snap to the element\n *\n * const removeSnap = snap.add(500)\n *\n * if (someCondition) {\n *   removeSnap()\n * }\n */\nexport default class Snap {\n  options: RequiredPick<SnapOptions, 'type' | 'velocityThreshold' | 'debounce'>\n  elements = new Map<UID, SnapElement>()\n  snaps = new Map<UID, SnapItem>()\n  viewport = {\n    width: window.innerWidth,\n    height: window.innerHeight,\n  }\n  isStopped = false\n  onSnapDebounced: () => void\n\n  constructor(\n    private lenis: Lenis,\n    {\n      type = 'mandatory',\n      lerp,\n      easing,\n      duration,\n      velocityThreshold = 1,\n      debounce: debounceDelay = 0,\n      onSnapStart,\n      onSnapComplete,\n    }: SnapOptions = {}\n  ) {\n    this.options = {\n      type,\n      lerp,\n      easing,\n      duration,\n      velocityThreshold,\n      debounce: debounceDelay,\n      onSnapStart,\n      onSnapComplete,\n    }\n\n    this.onWindowResize()\n    window.addEventListener('resize', this.onWindowResize, false)\n\n    this.onSnapDebounced = debounce(this.onSnap, this.options.debounce)\n\n    this.lenis.on('scroll', this.onScroll)\n  }\n\n  // debug() {\n  //   const element = document.createElement('div')\n  //   element.style.cssText = `\n  //     position: fixed;\n  //     background: red;\n  //     border-bottom: 1px solid red;\n  //     left: 0;\n  //     right: 0;\n  //     top: 0;\n  //     z-index: 9999;\n  //   `\n  //   document.body.appendChild(element)\n  // }\n\n  /**\n   * Destroy the snap instance\n   */\n  destroy() {\n    this.lenis.off('scroll', this.onScroll)\n    window.removeEventListener('resize', this.onWindowResize, false)\n    this.elements.forEach((element) => element.destroy())\n  }\n\n  /**\n   * Start the snap after it has been stopped\n   */\n  start() {\n    this.isStopped = false\n  }\n\n  /**\n   * Stop the snap\n   */\n  stop() {\n    this.isStopped = true\n  }\n\n  /**\n   * Add a snap to the snap instance\n   *\n   * @param value The value to snap to\n   * @param userData User data that will be forwarded through the snap event\n   * @returns Unsubscribe function\n   */\n  add(value: number, userData: UserData = {}) {\n    const id = uid()\n\n    this.snaps.set(id, { value, userData })\n\n    return () => this.remove(id)\n  }\n\n  /**\n   * Remove a snap from the snap instance\n   *\n   * @param id The snap id of the snap to remove\n   */\n  remove(id: UID) {\n    this.snaps.delete(id)\n  }\n\n  /**\n   * Add an element to the snap instance\n   *\n   * @param element The element to add\n   * @param options The options for the element\n   * @returns Unsubscribe function\n   */\n  addElement(element: HTMLElement, options = {} as SnapElementOptions) {\n    const id = uid()\n\n    this.elements.set(id, new SnapElement(element, options))\n\n    return () => this.removeElement(id)\n  }\n\n  /**\n   * Remove an element from the snap instance\n   *\n   * @param id The snap id of the snap element to remove\n   */\n  removeElement(id: UID) {\n    this.elements.delete(id)\n  }\n\n  private onWindowResize = () => {\n    this.viewport.width = window.innerWidth\n    this.viewport.height = window.innerHeight\n  }\n\n  private onScroll = ({\n    // scroll,\n    // limit,\n    lastVelocity,\n    velocity,\n    // isScrolling,\n    userData,\n  }: // isHorizontal,\n  Lenis) => {\n    if (this.isStopped) return\n    // console.log(scroll, velocity, type)\n\n    // return\n    const isDecelerating = Math.abs(lastVelocity) > Math.abs(velocity)\n    const isTurningBack =\n      Math.sign(lastVelocity) !== Math.sign(velocity) && velocity !== 0\n\n    // console.log({ lastVelocity, velocity, isTurningBack, isDecelerating })\n\n    // console.log('onScroll')\n\n    if (\n      Math.abs(velocity) < this.options.velocityThreshold &&\n      // !isTouching &&\n      isDecelerating &&\n      !isTurningBack &&\n      userData?.initiator !== 'snap'\n    ) {\n      this.onSnapDebounced()\n    }\n  }\n\n  private onSnap = () => {\n    let { scroll, isHorizontal } = this.lenis\n    scroll = Math.ceil(this.lenis.scroll)\n\n    let snaps = [...this.snaps.values()] as SnapItem[]\n\n    this.elements.forEach(({ rect, align }) => {\n      let value: number | undefined\n\n      align.forEach((align) => {\n        if (align === 'start') {\n          value = rect.top\n        } else if (align === 'center') {\n          value = isHorizontal\n            ? rect.left + rect.width / 2 - this.viewport.width / 2\n            : rect.top + rect.height / 2 - this.viewport.height / 2\n        } else if (align === 'end') {\n          value = isHorizontal\n            ? rect.left + rect.width - this.viewport.width\n            : rect.top + rect.height - this.viewport.height\n        }\n\n        if (typeof value === 'number') {\n          snaps.push({ value: Math.ceil(value), userData: {} })\n        }\n      })\n    })\n\n    snaps = snaps.sort((a, b) => Math.abs(a.value) - Math.abs(b.value))\n\n    let prevSnap = snaps.findLast(({ value }) => value <= scroll)\n    if (prevSnap === undefined) prevSnap = snaps[0]\n    const distanceToPrevSnap = Math.abs(scroll - prevSnap.value)\n\n    let nextSnap = snaps.find(({ value }) => value >= scroll)\n    if (nextSnap === undefined) nextSnap = snaps[snaps.length - 1]\n    const distanceToNextSnap = Math.abs(scroll - nextSnap.value)\n\n    const snap = distanceToPrevSnap < distanceToNextSnap ? prevSnap : nextSnap\n\n    const distance = Math.abs(scroll - snap.value)\n\n    if (\n      this.options.type === 'mandatory' ||\n      (this.options.type === 'proximity' &&\n        distance <=\n          (isHorizontal\n            ? this.lenis.dimensions.width\n            : this.lenis.dimensions.height))\n    ) {\n      // this.__isScrolling = true\n      // this.onSnapStart?.(snap)\n\n      // console.log('scroll to')\n\n      this.lenis.scrollTo(snap.value, {\n        lerp: this.options.lerp,\n        easing: this.options.easing,\n        duration: this.options.duration,\n        userData: { initiator: 'snap' },\n        onStart: () => {\n          this.options.onSnapStart?.(snap)\n        },\n        onComplete: () => {\n          this.options.onSnapComplete?.(snap)\n        },\n      })\n    }\n\n    // console.timeEnd('scroll')\n  }\n}\n","export function debounce<CB extends (...args: any[]) => void>(\n  callback: CB,\n  delay: number\n) {\n  let timer: number | undefined\n  return function <T>(this: T, ...args: Parameters<typeof callback>) {\n    let context = this\n    clearTimeout(timer)\n    timer = setTimeout(() => {\n      timer = undefined\n      callback.apply(context, args)\n    }, delay)\n  }\n}\n"],"names":["removeParentSticky","element","getComputedStyle","position","style","setProperty","dataset","sticky","offsetParent","addParentSticky","_a","removeProperty","offsetTop","accumulator","top","offsetLeft","left","scrollTop","window","scrollY","scrollLeft","scrollX","SnapElement","constructor","align","ignoreSticky","ignoreTransform","this","rect","onWrapperResize","options","getBoundingClientRect","setRect","onResize","entry","width","borderBoxSize","inlineSize","height","blockSize","flat","wrapperResizeObserver","ResizeObserver","observe","document","body","resizeObserver","offsetWidth","offsetHeight","destroy","disconnect","y","x","bottom","right","index","uid","Snap","lenis","type","lerp","easing","duration","velocityThreshold","debounce","debounceDelay","onSnapStart","onSnapComplete","elements","Map","snaps","viewport","innerWidth","innerHeight","isStopped","onWindowResize","onScroll","lastVelocity","velocity","userData","isDecelerating","Math","abs","isTurningBack","sign","initiator","onSnapDebounced","onSnap","scroll","isHorizontal","ceil","values","forEach","value","push","sort","a","b","prevSnap","findLast","undefined","distanceToPrevSnap","nextSnap","find","length","snap","distance","dimensions","scrollTo","onStart","_b","call","onComplete","addEventListener","callback","delay","timer","args","context","clearTimeout","setTimeout","apply","on","off","removeEventListener","start","stop","add","id","set","remove","delete","addElement","removeElement"],"mappings":"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"}