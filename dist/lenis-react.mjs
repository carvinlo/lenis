import{jsx as r}from"react/jsx-runtime";import e from"@darkroom.engineering/tempus";import t from"lenis";export{default}from"lenis";import{useState as n,useEffect as s,createContext as i,forwardRef as l,useRef as o,useImperativeHandle as c,useCallback as a,useContext as u}from"react";const f=i(null),d=new class Store{constructor(r){this.state=r,this.listeners=[]}set(r){this.state=r;for(let r of this.listeners)r(this.state)}subscribe(r){return this.listeners=[...this.listeners,r],()=>{this.listeners=this.listeners.filter((e=>e!==r))}}get(){return this.state}}(null);function useLenis(r,e=[],t=0){var i;const l=u(f),o=function useStore(r){const[e,t]=n(r.get());return s((()=>r.subscribe((r=>t(r)))),[r]),e}(d),{lenis:c,addCallback:a,removeCallback:p}=null!==(i=null!=l?l:o)&&void 0!==i?i:{};return s((()=>{if(r&&a&&p&&c)return a(r,t),r(c),()=>{p(r)}}),[c,a,p,t,...e]),c}const p=l((({children:i,root:l=!1,options:u={},autoRaf:p=!0,rafPriority:m=0,className:b,props:h},v)=>{const k=o(null),g=o(null),[y,C]=n(void 0);c(v,(()=>({wrapper:k.current,content:g.current,lenis:y})),[y]),s((()=>{const r=new t(Object.assign(Object.assign({},u),!l&&{wrapper:k.current,content:g.current}));return C(r),()=>{r.destroy(),C(void 0)}}),[l,JSON.stringify(u)]),s((()=>{if(y&&p)return e.add((r=>y.raf(r)),m)}),[y,p,m]);const j=o([]),w=a(((r,e)=>{j.current.push({callback:r,priority:e}),j.current.sort(((r,e)=>r.priority-e.priority))}),[]),O=a((r=>{j.current=j.current.filter((e=>e.callback!==r))}),[]);return s((()=>{if(l&&y)return d.set({lenis:y,addCallback:w,removeCallback:O}),()=>d.set(null)}),[l,y,w,O]),s((()=>{if(!y)return;const onScroll=r=>{for(let e=0;e<j.current.length;e++)j.current[e].callback(r)};return y.on("scroll",onScroll),()=>{y.off("scroll",onScroll)}}),[y]),r(f.Provider,{value:{lenis:y,addCallback:w,removeCallback:O},children:l?i:r("div",Object.assign({ref:k,className:b},h,{children:r("div",{ref:g,children:i})}))})}));export{p as Lenis,f as LenisContext,p as ReactLenis,useLenis};
//# sourceMappingURL=lenis-react.mjs.map
